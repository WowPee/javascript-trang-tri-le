function pageWidth(){return null!=window.innerWidth?window.innerWidth:null!=document.body?document.body.clientWidth:null}function pageHeight(){return null!=window.innerHeight?window.innerHeight:null!=document.body?document.body.clientHeight:null}function posLeft(){return"undefined"!=typeof window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft?document.body.scrollLeft:0}
function posTop(){return"undefined"!=typeof window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function d2h(a){return hD.substr(a>>>4,1)+hD.substr(15&a,1)}function stopfire(){for(var a=firestop.length-1;0<=a;a--){clearInterval(firestop[a]);for(var b=fire[a].sp.length-1;0<=b;b--)fire[a].sp[b].style.visibility="hidden"}}
function fireworks(){new fo(50);setTimeout("new fo(50)",750);0<stopafter&&setTimeout("stopfire()",6E4*stopafter)}var stopafter=0,firestop=[],fire=[],stdDOM=document.getElementById,nsDOM=-1!=navigator.appName.indexOf("Netscape")&&4==parseInt(navigator.appVersion),hD="0123456789ABCDEF";layernum=0;
piece=function(a){(this.elem=null,nsDOM)?(null==a?this.elem=new Layer(1):(this.elem=new Layer(1,a.elem),this.style.visibility="inherit"),this.parent=a,this.style=this.elem):stdDOM&&(null==a?this.parent=document.body:this.parent=a.elem,this.elem=document.createElement("div"),a="xLayer"+layernum++,this.elem.setAttribute("id",a),elemc=document.createTextNode("."),this.elem.appendChild(elemc),this.parent.appendChild(this.elem),this.style=this.elem.style,document.getElementById(a).style.lineHeight="3px",
document.getElementById(a).style.zIndex="999999999999999999",document.getElementById(a).style.color="#fff",document.getElementById(a).style.position="absolute");window[this.elem.id]=this;this.ay=.1;this.type=0};piece.prototype.moveTo=function(a,b){nsDOM?this.elem.moveTo(a,b):(this.style.left=a+"px",this.style.top=b+"px")};piece.prototype.setC=function(a){nsDOM?this.elem.bgColor=a:this.style.backgroundColor=null==a?"transparent":a};
piece.prototype.fire=function(a,b,c){var d=Math.random()*Math.PI*2;switch(c){case 1:c=2*Math.random();break;case 2:c=2;break;case 3:c=2*Math.PI-d-Math.random();break;case 4:c=d-Math.random();break;default:c=2*Math.random(),.6<Math.random()&&(c=1.5)}this.dx=c*Math.sin(d);this.dy=c*Math.cos(d)-2;this.x=a;this.y=b;this.moveTo(a,b)};
piece.prototype.sCol=function(a,b,c){switch(c){case 1:this.setC("#"+a+b+"00");break;case 2:this.setC("#00"+a+"00");break;case 3:this.setC("#00"+a+b);break;case 4:this.setC("#"+a+"0000");break;case 5:this.setC("#"+a+a+"00");break;case 6:this.setC("#"+a+a+a);break;case 7:this.setC("#"+b+a+"00");break;default:this.setC("#"+a+b+a)}};
piece.prototype.animate=function(a,b){var c=25<a?Math.random()*(380-5*a):255-4*a,d=d2h(c-112);112>c&&(d=d2h(c));this.sCol(d2h(c),d,b);this.dy+=this.ay;this.x+=this.dx;this.y+=this.dy;this.moveTo(this.x,this.y)};
fo=function(a){this.id="fo"+fo.count++;this.sp=[];for(i=0;i<a;i++)this.sp[i]=new piece,nsDOM?(this.sp[i].style.clip.top=0,this.sp[i].style.clip.left=0,this.sp[i].style.clip.bottom=3,this.sp[i].style.clip.right=3):this.sp[i].style.clip="rect(0 3 3 0)",this.sp[i].style.visibility="visible";this.step=0;window[this.id]=this;fire.push(this);firestop.push(setInterval("window."+this.id+".animate()",15))};fo.count=0;
fo.prototype.animate=function(){if(55<this.step&&(this.step=0),0==this.step){var a=posLeft()+50+Math.random()*(pageWidth()-200),b=posTop()+50+Math.random()*(pageHeight()-250),c=Math.floor(5*Math.random());this.cl=Math.floor(8*Math.random());for(i=0;i<this.sp.length;i++)this.sp[i].fire(a,b,c)}this.step++;for(i=0;i<this.sp.length;i++)this.sp[i].animate(this.step,this.cl)};window.onload=fireworks;